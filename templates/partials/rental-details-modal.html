<!-- Rental Details Modal for request {{ req.rr_id }} -->
<div id="view-details-modal-{{ req.rr_id }}" class="uk-flex-top" uk-modal>
    <div class="uk-modal-dialog uk-modal-body uk-margin-auto-vertical rounded-lg lg:w-1/2">
        <button class="uk-modal-close-default" type="button" uk-close></button>
        
        <h2 class="uk-modal-title text-2xl font-semibold mb-4">Rental Details</h2>

        <div class="space-y-6">
            <!-- Rental Summary -->
            <div class="p-4 bg-gray-50 rounded-lg">
                <h3 class="font-semibold text-lg mb-3">Rental Summary</h3>
                <div class="grid grid-cols-2 gap-3 text-sm">
                    <div>
                        <p class="text-gray-500">Rental ID</p>
                        <p class="font-semibold">{{ req.rr_id }}</p>
                    </div>
                    <div>
                        <p class="text-gray-500">Status</p>
                        <p class="font-semibold">
                            {% if req.status == 'Pending' %}
                                <span class="bg-yellow-100 text-yellow-600 px-2 py-1 rounded-md text-xs font-bold">Pending</span>
                            {% elif req.status == 'Approved' %}
                                <span class="bg-blue-100 text-blue-600 px-2 py-1 rounded-md text-xs font-bold">Approved</span>
                            {% elif req.status == 'Declined' %}
                                <span class="bg-red-100 text-red-600 px-2 py-1 rounded-md text-xs font-bold">Declined</span>
                            {% elif req.status == 'Paid' %}
                                <span class="bg-purple-100 text-purple-600 px-2 py-1 rounded-md text-xs font-bold">Paid</span>
                            {% elif req.status == 'Ongoing' %}
                                <span class="bg-green-100 text-green-600 px-2 py-1 rounded-md text-xs font-bold">Ongoing</span>
                            {% elif req.status == 'Completed' %}
                                <span class="bg-gray-100 text-gray-600 px-2 py-1 rounded-md text-xs font-bold">Completed</span>
                            {% elif req.status == 'Cancelled' %}
                                <span class="bg-red-100 text-red-600 px-2 py-1 rounded-md text-xs font-bold">Cancelled</span>
                            {% endif %}
                        </p>
                    </div>
                    <div>
                        <p class="text-gray-500">Requested On</p>
                        <p class="font-semibold">{{ req.date|date:"M d, Y" }}</p>
                    </div>
                </div>
            </div>

            <!-- Item & Parties -->
            <div class="grid md:grid-cols-2 gap-6">
                <!-- Item Info -->
                <div>
                    <h3 class="font-semibold text-lg mb-3">Item Information</h3>
                    <div class="flex items-center space-x-4">
                        <img src="{{ req.product.image.url }}" class="w-20 h-20 rounded-lg object-cover" alt="">
                        <div class="flex-1">
                            <p class="font-bold text-lg">{{ req.product.title }}</p>
                            <p class="text-sm text-gray-500">{{ req.product.location }}</p>
                        </div>
                    </div>
                </div>
                <!-- Parties -->
                <div>
                    <h3 class="font-semibold text-lg mb-3">Parties Involved</h3>
                    <div class="space-y-3">
                        <div class="flex items-center space-x-3">
                            <img src="{{ req.owner.profile.image.url }}" class="w-10 h-10 rounded-full" alt="">
                            <div>
                                <p class="text-gray-500 text-sm">Owner</p>
                                <p class="font-semibold">{{ req.owner.profile.full_name }}</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3">
                            <img src="{{ req.renter.profile.image.url }}" class="w-10 h-10 rounded-full" alt="">
                            <div>
                                <p class="text-gray-500 text-sm">Renter</p>
                                <p class="font-semibold">{{ req.renter.profile.full_name }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Period & Pricing -->
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <h3 class="font-semibold text-lg mb-3">Rental Period & Pricing</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between"><span class="text-gray-500">Start Date</span><span class="font-semibold">{{ req.start_date|date:"M d, Y" }}</span></div>
                        <div class="flex justify-between"><span class="text-gray-500">End Date</span><span class="font-semibold">{{ req.end_date|date:"M d, Y" }}</span></div>
                        <hr>
                        <div class="flex justify-between"><span class="text-gray-500">Daily Rate</span><span>RM {{ req.product.daily_rate|floatformat:2 }}</span></div>
                        <div class="flex justify-between"><span class="text-gray-500">Total Days</span><span>{{ req.total_days }}</span></div>
                        <div class="flex justify-between font-bold text-base mt-2"><span>Total Price</span><span class="text-blue-600">RM {{ req.total_price|floatformat:2 }}</span></div>
                    </div>
                </div>

                <!-- Timeline -->
                <div>
                    <h3 class="font-semibold text-lg mb-3">Rental Timeline</h3>
                    <ul class="space-y-2 text-sm">
                        <li class="flex items-center space-x-2"><ion-icon name="checkmark-circle" class="text-green-500 text-lg"></ion-icon><span>Request Submitted</span></li>
                        <li class="flex items-center space-x-2 {% if req.status == 'Pending' %}text-gray-400{% endif %}">
                            {% if req.status == 'Approved' or req.status == 'Paid' or req.status == 'Ongoing' or req.status == 'Completed' %}<ion-icon name="checkmark-circle" class="text-green-500 text-lg"></ion-icon><span>Approved on {{ req.approved_at|date:"M d, Y" }}</span>
                            {% elif req.status == 'Declined' or req.status == 'Cancelled' %}<ion-icon name="close-circle" class="text-red-500 text-lg"></ion-icon><span>{{ req.status }}</span>
                            {% else %}<ion-icon name="ellipse-outline" class="text-gray-400 text-lg"></ion-icon><span>Awaiting Approval</span>{% endif %}
                        </li>
                        <li class="flex items-center space-x-2 {% if not req.paid_at %}text-gray-400{% endif %}">
                            {% if req.paid_at %}<ion-icon name="checkmark-circle" class="text-green-500 text-lg"></ion-icon><span>Payment Confirmed on {{ req.paid_at|date:"M d, Y" }}</span>
                            {% else %}<ion-icon name="ellipse-outline" class="text-gray-400 text-lg"></ion-icon><span>Awaiting Payment</span>{% endif %}
                        </li>
                        <li class="flex items-center space-x-2 {% if not req.handed_over %}text-gray-400{% endif %}">
                            {% if req.handed_over %}<ion-icon name="checkmark-circle" class="text-green-500 text-lg"></ion-icon><span>Item Handed Over</span>
                            {% else %}<ion-icon name="ellipse-outline" class="text-gray-400 text-lg"></ion-icon><span>Awaiting Handover</span>{% endif %}
                        </li>
                        <li class="flex items-center space-x-2 {% if not req.received %}text-gray-400{% endif %}">
                            {% if req.received %}<ion-icon name="checkmark-circle" class="text-green-500 text-lg"></ion-icon><span>Item Received</span>
                            {% else %}<ion-icon name="ellipse-outline" class="text-gray-400 text-lg"></ion-icon><span>Awaiting Receipt</span>{% endif %}
                        </li>
                        <li class="flex items-center space-x-2 {% if not req.returned_confirmed %}text-gray-400{% endif %}">
                            {% if req.returned_confirmed %}<ion-icon name="checkmark-circle" class="text-green-500 text-lg"></ion-icon><span>Renter Marked Returned</span>
                            {% else %}<ion-icon name="ellipse-outline" class="text-gray-400 text-lg"></ion-icon><span>Awaiting Return</span>{% endif %}
                        </li>
                        <li class="flex items-center space-x-2 {% if not req.returned %}text-gray-400{% endif %}">
                            {% if req.returned %}<ion-icon name="checkmark-circle" class="text-green-500 text-lg"></ion-icon><span>Return Confirmed</span>
                            {% else %}<ion-icon name="ellipse-outline" class="text-gray-400 text-lg"></ion-icon><span>Awaiting Return Confirmation</span>{% endif %}
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>